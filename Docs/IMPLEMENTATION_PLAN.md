# 実装計画書

## 開発ステータス（2025-12-01時点）

現状はドキュメントのみが存在し、ゲーム本体の実装にはまだ着手していません。以下のフェーズ計画に沿って開発を進める想定です。

### フェーズ1: MVP（未着手）
- 3Dシーン構築（Three.js）
- プレイヤー移動・射撃（マガジン式: 7発/0.7秒リロード）
- 敵複数種類
- 障害物
- 衝突判定
- 背景スクロール（地面・星空）
- HP管理・ゲームオーバー

### フェーズ2: ステージシステム（未着手）
- スコアシステム（localStorage保存）
- 5ステージ構成（Stage1:60秒, Stage2:90秒, Stage3:90秒, Stage4:120秒, Stage5:120秒でボス出現→撃破でクリア）
- ステージクリア画面
- ステージ毎の背景色変更
- ゲームスピード倍率（1.0x, 1.5x, 4.0x, 1.0x, 2.5x）
- 障害物頻度と構成（Stage3は障害物のみで道中敵は出さない）
- 天井スクロール（Stage 3, 5）
- 敵弾システム（Stage2/5のTypeBと各ボス固有弾）

## 技術仕様

### ゲームスピード倍率システム
- `stageConfig.gameSpeed`で各ステージの速度を制御
- 適用対象: 敵移動、障害物移動、背景スクロール
- 目標値: Stage1=1.0x, Stage2=1.5x, Stage3=4.0x, Stage4=1.0x, Stage5=2.5x

### ステージ進行・敵配置
- `stageConfig.duration`でボス出現タイミングを管理（Stage1:60秒、Stage2:90秒、Stage3:90秒、Stage4:120秒、Stage5:120秒）
- Stage4/5は60秒経過時に中ボスを出現させ、その撃破後に残り時間分のウェーブ→最終ボスへ移行
- Stage3は道中敵を発生させず、障害物とボスのみの構成にする
- 障害物/敵のスポーンテーブルをステージ毎に定義し、頻度や種類を切り替える

### 敵弾システム
- TypeB連隊のZ=-30トリガー射撃（Stage2/5）
- 各ボス固有の弾幕パターン（Stage3はボス弾のみ）
- 弾速・射出間隔は`stageConfig`に紐づけてチューニング

### 天井システム
- Stage 3, 5で有効
- 地面と同じチェッカーボードパターン
- 地面と逆方向のUVオフセットでスクロールし、トンネル感を演出

## 今後の実装予定

### フェーズ3: ボス実装
- **中ボス**
- **ステージ毎の最終ボス**

### フェーズ4: UI改善（オプション）
- タイトル画面
- ハイスコアランキング表示
- 操作説明画面

### フェーズ5: サウンド（オプション）
- BGM（ステージ毎）
- 効果音（射撃、爆発、ダメージ）

## アーキテクチャ

### クラス構成
- `Game.ts`: メインループ、状態管理
- `Player.ts`: プレイヤー操作、マガジン管理
- `Enemy.ts`: 敵基底クラス
- `EnemyTypeA/B/C.ts`: 各敵タイプの実装
- `EnemyBullet.ts`: 敵弾
- `Background.ts`: 地面・天井・星空、スピード管理
- `StageData.ts`: ステージ設定データ

### 状態管理
- ゲーム状態: `'playing' | 'gameover' | 'stageclear'`
- スコア: ScoreManagerで管理（localStorage保存）
- ステージ: currentStage（1-5）

## デプロイ

```bash
npm run build
npm run deploy
```

GitHub Pages: https://wikeda.github.io/3d-stg-codex/

---

**最終更新**: 2025-12-01  
**バージョン**: 0.1（計画状態）
