# 実装計画書

## 実装済み機能（v2.0）

### フェーズ1: MVP ✅
- 3Dシーン構築（Three.js）
- プレイヤー移動・射撃（マガジン式: 7発/0.7秒リロード）
- 敵3種類（TypeA直線、TypeBサインウェーブ、TypeCジグザグ追尾）
- 障害物（岩・柱）
- 衝突判定
- 背景スクロール（地面・星空）
- HP管理・ゲームオーバー

### フェーズ2: ステージシステム ✅
- スコアシステム（localStorage保存）
- 5ステージ構成（スコアベースクリア）
- ステージクリア画面
- ステージ毎の背景色変更
- ゲームスピード倍率（1.0x～2.0x）
- 天井スクロール（Stage 3, 5）
- 敵弾システム（EnemyTypeB、Z=-30で1発発射）

## 技術仕様

### ゲームスピード倍率システム
- `stageConfig.gameSpeed`で各ステージの速度を制御
- 適用対象: 敵移動、障害物移動、背景スクロール
- Stage 1: 1.0x, Stage 2: 1.3x, Stage 3: 1.6x, Stage 4: 1.0x, Stage 5: 2.0x

### 敵弾システム
- EnemyTypeBのみが射撃可能
- 発射条件: Z座標が-30に到達したとき1回のみ
- 弾仕様: 半径1.5、速度10、赤色発光
- 有効ステージ: 2, 3, 5

### 天井システム
- Stage 3, 5で有効
- 地面と同じチェッカーボードパターン
- 地面と逆方向のオフセットでスクロール

## 今後の実装予定

### フェーズ3: ボス実装
1. **中ボス（Stage 4）**
   - 静止した大型敵
   - 高HP（10-20発）
   - 複数方向に弾幕
   - 撃破でステージクリア

2. **蛇型ボス（Stage 5）**
   - 分節構造（5-7セグメント）
   - 頭部のみダメージ有効
   - 全体撃破でゲームクリア
   - 弾発射

### フェーズ4: UI改善（オプション）
- タイトル画面
- ハイスコアランキング表示
- 操作説明画面

### フェーズ5: サウンド（オプション）
- BGM（ステージ毎）
- 効果音（射撃、爆発、ダメージ）

## アーキテクチャ

### クラス構成
- `Game.ts`: メインループ、状態管理
- `Player.ts`: プレイヤー操作、マガジン管理
- `Enemy.ts`: 敵基底クラス
- `EnemyTypeA/B/C.ts`: 各敵タイプの実装
- `EnemyBullet.ts`: 敵弾
- `Background.ts`: 地面・天井・星空、スピード管理
- `StageData.ts`: ステージ設定データ

### 状態管理
- ゲーム状態: `'playing' | 'gameover' | 'stageclear'`
- スコア: ScoreManagerで管理（localStorage保存）
- ステージ: currentStage（1-5）

## デプロイ

```bash
npm run build
npm run deploy
```

GitHub Pages: https://wikeda.github.io/3d-stg/

---

**最終更新**: 2025-12-01  
**バージョン**: 2.0
